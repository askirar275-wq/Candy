<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Choose Username</title>
<style>
body{background:#020617;color:#fff;font-family:Arial}
.box{max-width:360px;margin:100px auto;background:#020617;padding:20px;border-radius:14px}
input,button{width:100%;padding:12px;margin-top:10px;border-radius:10px;border:none}
button{background:#2563eb;color:#fff}
</style>
</head>
<body>

<div class="box">
  <h2>Choose Username</h2>
  <input id="username" placeholder="username">
  <button onclick="save()">Continue</button>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
import { getAuth } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-auth.js";
import { getFirestore, doc, setDoc } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyA7U96MP2BheQ1ilIUqd2UgycPs8KVC-Gc",
  authDomain: "chatapp-d38d3.firebaseapp.com",
  projectId: "chatapp-d38d3",
  appId: "1:321814992234:web:d1d8eb9d63fcafc53ec113"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

window.save = async ()=>{
  const u = username.value.trim();
  if(!u) return alert("Enter username");

  await setDoc(doc(db,"users",auth.currentUser.uid),{
    username:u,
    uid:auth.currentUser.uid
  });

  location.href="home.html";
};
</script>
</body>
</html>
