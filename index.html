<!doctype html>
<html lang="hi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Candy Match</title>
  <style>
    /* Minimal mobile-friendly styles ‚Äî you can replace with style.css later */
    :root{ --bg: #f6fbff; --card:#fff; --accent:#28a7ff; --radius:14px; --muted:#777;}
    html,body{height:100%;margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,"Noto Sans",Arial; background: linear-gradient(180deg,#f7fdff 0%, #eef7fb 100%);}
    .wrap{max-width:720px;margin:0 auto;padding:18px;}
    .card{background:var(--card);border-radius:var(--radius);padding:18px;box-shadow:0 8px 24px rgba(10,10,20,0.06);}
    header h1{margin:0;font-size:28px;text-align:center;}
    .cta-row{display:flex;gap:12px;justify-content:center;margin-top:14px;flex-wrap:wrap;}
    .btn{background:var(--accent);color:#fff;padding:10px 16px;border-radius:10px;border:0;box-shadow:none;font-weight:600}
    .small-btn{background:#fff;color:var(--accent);border:2px solid #e6f3ff;padding:8px 12px;border-radius:10px}
    nav.links{display:flex;gap:12px;justify-content:center;margin-top:12px}
    nav.links a{color:#6b2f8f;text-decoration:underline}
    /* pages */
    .page{display:none;margin-top:18px}
    .page.active{display:block}
    /* stats row (your requested) */
    .stats-row{display:flex;gap:10px;flex-wrap:wrap;justify-content:center;margin:18px 0}
    .stat{background:#fff;padding:10px 14px;border-radius:12px;box-shadow:0 6px 18px rgba(10,10,20,.06);min-width:110px;text-align:center}
    #gameGrid{display:grid; gap:10px; max-width:360px; margin:18px auto 28px; touch-action:none;}
    .cell{background:rgba(255,255,255,0.9);height:52px;border-radius:10px;display:flex;align-items:center;justify-content:center;position:relative;box-shadow:0 6px 18px rgba(10,10,20,0.04);}
    .cell img{width:44px;height:44px;object-fit:contain;pointer-events:none;user-select:none}
    .cell.fade-out{opacity:.3;transform:scale(.96)}
    .dragging-clone{pointer-events:none;opacity:.98;border-radius:10px;box-shadow:0 20px 40px rgba(10,10,20,0.12)}
    /* small badges */
    .obs{font-size:12px;color:#222}
    .badge{font-size:14px}
    /* map grid */
    #mapGrid{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-top:12px}
    .level-card{background:#fff;padding:10px;border-radius:12px; text-align:center; box-shadow:0 8px 20px rgba(10,10,20,0.05)}
    .level-card.locked{opacity:.45;filter:grayscale(.2)}
    /* over / buttons */
    #page-over .card{max-width:520px;margin:18px auto;padding:20px}
    .stars-row{display:flex;gap:6px}
    .star{font-size:20px;color:gold}
    footer{margin:30px 0;text-align:center;color:var(--muted)}
    /* responsive tweaks */
    @media (max-width:420px){
      .stat{min-width:92px;padding:8px}
      #gameGrid{gap:8px}
      .cell{height:58px}
      .cell img{width:46px;height:46px}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <!-- Header / Home -->
    <header class="card" id="page-home">
      <h1>üç¨ Candy Match</h1>
      <p style="text-align:center;color:var(--muted);margin:8px 0 0">Match. Pop. Smile!</p>
      <div class="cta-row" style="margin-top:14px">
        <button class="btn" id="btnPlay">Play</button>
        <button class="btn" id="btnMap">Map</button>
      </div>
      <nav class="links" style="margin-top:12px">
        <a href="#map" id="linkMap">Level Map</a>
        <a href="#settings" id="linkSettings">Settings</a>
        <a href="#about" id="linkAbout">About</a>
      </nav>
    </header>

    <!-- Level Map page -->
    <section id="page-map" class="page card">
      <button class="small-btn" id="backFromMap">‚Üê Back</button>
      <h2>Level Map</h2>
      <div style="margin-top:10px">
        <button class="small-btn" id="resetProgress">Reset Progress</button>
      </div>
      <div id="mapGrid"></div>
    </section>

    <!-- Game page -->
    <section id="page-game" class="page card">
      <button class="small-btn" id="backFromGame">‚Üê Map</button>
      <h2 id="levelTitle">Level 1</h2>

      <!-- *** YOUR REQUESTED stats-row inserted here *** -->
      <div class="stats-row">
        <div class="stat">Score: <span id="score">0</span></div>
        <div class="stat">Moves: <span id="moves">30</span></div>
        <div class="stat">Target: <span id="target">600</span></div>
        <div class="stat">Timer: <span id="timer">--:--</span></div>
      </div>

      <div style="display:flex;gap:10px;justify-content:center;margin-bottom:6px">
        <div class="stars-row" id="stars" aria-hidden="true">
          <div class="star">‚òÜ</div><div class="star">‚òÜ</div><div class="star">‚òÜ</div>
        </div>
      </div>

      <div id="gameGrid" role="grid" aria-label="Game grid"></div>

      <div style="text-align:center;margin-top:10px">
        <button class="small-btn" id="btnEnd">End</button>
        <button class="small-btn" id="btnRestart">Restart</button>
      </div>
    </section>

    <!-- Game over / level complete page -->
    <section id="page-over" class="page card">
      <h2 id="overTitle">Level Complete!</h2>
      <p id="overScore">Score: 0</p>
      <div style="display:flex;gap:12px;justify-content:center;margin-top:12px">
        <button class="btn" id="btnReplay">Replay</button>
        <button class="btn" id="btnNext">Next</button>
        <button class="small-btn" id="btnToMap">Map</button>
      </div>
    </section>

    <footer>
      <small>Made with ‚ù§Ô∏è ‚Äî test on mobile and desktop</small>
    </footer>
  </div>

  <!-- scripts (order matters) -->
  <script src="js/storage.js"></script>
  <script src="js/confetti.js"></script>
  <script src="js/game-core.js"></script>
  <script src="js/game.js"></script>
  <script src="js/sound.js"></script>

  <!-- startup script: init UI nav-binding and start selected level if query param present -->
  <script>
    (function(){
      // simple nav show/hide
      function showPage(id){
        document.querySelectorAll('.page, header.card').forEach(el=>{
          // header is home (id page-home)
          if(el.id === id) el.classList.add('active'); else el.classList.remove('active');
        });
      }

      // map buttons
      document.getElementById('btnMap').addEventListener('click', ()=> {
        document.getElementById('page-home').classList.remove('active');
        document.getElementById('page-map').classList.add('active');
        if(window.LevelMap) LevelMap.render();
      });
      document.getElementById('linkMap').addEventListener('click', (e)=>{ e.preventDefault(); document.getElementById('btnMap').click(); });

      document.getElementById('btnPlay').addEventListener('click', ()=> {
        document.getElementById('page-home').classList.remove('active');
        document.getElementById('page-game').classList.add('active');
        // start default level 1
        if(window.Game) Game.start(1);
      });

      document.getElementById('backFromMap').addEventListener('click', ()=> {
        document.getElementById('page-map').classList.remove('active');
        document.getElementById('page-home').classList.add('active');
      });
      document.getElementById('backFromGame').addEventListener('click', ()=> {
        document.getElementById('page-game').classList.remove('active');
        document.getElementById('page-map').classList.add('active');
      });

      // over page buttons
      document.getElementById('btnReplay').addEventListener('click', ()=> { document.getElementById('page-over').classList.remove('active'); document.getElementById('page-game').classList.add('active'); if(window.Game) Game.restart(); });
      document.getElementById('btnNext').addEventListener('click', ()=> { document.getElementById('page-over').classList.remove('active'); document.getElementById('page-map').classList.add('active'); if(window.LevelMap) LevelMap.render(); });

      document.getElementById('btnToMap').addEventListener('click', ()=> { document.getElementById('page-over').classList.remove('active'); document.getElementById('page-map').classList.add('active'); if(window.LevelMap) LevelMap.render(); });
      document.getElementById('btnEnd').addEventListener('click', ()=> { if(window.Game) { document.getElementById('page-game').classList.remove('active'); document.getElementById('page-over').classList.add('active'); } });
      document.getElementById('btnRestart').addEventListener('click', ()=> { if(window.Game) Game.restart(); });

      // reset progress
      document.getElementById('resetProgress').addEventListener('click', ()=> { if(confirm('Reset progress?')){ Storage.reset(); LevelMap.render(); alert('Progress reset'); } });

      // start home
      document.getElementById('page-home').classList.add('active');

      // start level from query param e.g. ?level=1
      (function(){
        try {
          const urlParams = new URLSearchParams(location.search);
          const lvl = urlParams.get('level');
          if(lvl && window.Game){
            // show page-game and start
            document.getElementById('page-home').classList.remove('active');
            document.getElementById('page-game').classList.add('active');
            // small safety wait for Game loaded
            function startWhenReady(){
              if(typeof Game !== 'undefined'){
                Game.start(Number(lvl) || 1);
              } else {
                window.addEventListener('load', ()=> { if(typeof Game !== 'undefined') Game.start(Number(lvl)||1); });
              }
            }
            startWhenReady();
          }
        } catch(e){ console.error('Game start failed', e); }
      })();

    })();
  </script>
</body>
  </html>
