<!doctype html>
<html lang="hi">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Candy Match ‚Äî GitHub Updated</title>
<style>
:root {
  --cols:8; --rows:8; --gap:4px; --tile:68px; --accent:#ff4d9e;
  --pop-dur:300ms; --fall-dur:320ms;
}
*{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
html,body{height:100%;margin:0;font-family:Inter,system-ui,Roboto,Arial;
background:linear-gradient(180deg,#fff9fc,#f2f7ff);color:#222}
body{overflow:hidden}
.stage{min-height:100vh;display:flex;align-items:center;justify-content:center;padding:8px}
.card{width:100%;max-width:980px;height:calc(100vh - 16px);padding:12px;
border-radius:14px;background:#fff;box-shadow:0 18px 48px rgba(20,20,50,.06);
display:flex;flex-direction:column;gap:10px;overflow:hidden}
header{display:flex;align-items:center;justify-content:space-between}
.brand{display:flex;gap:12px;align-items:center}
.logo{width:52px;height:52px;border-radius:12px;background:linear-gradient(135deg,#fff0f6,#ffeef8);
display:flex;align-items:center;justify-content:center;font-size:26px}
.hud{display:flex;gap:10px;align-items:center}
.pill{background:linear-gradient(180deg,#fff,#fff7fb);padding:8px 14px;border-radius:40px;font-weight:800}
.content{display:flex;flex-direction:column;gap:8px;flex:1 1 auto;min-height:0}
.grid-area{flex:1 1 auto;display:flex;align-items:center;justify-content:center;padding:6px}
.grid-wrap{width:100%;max-width:860px;border-radius:12px;background:linear-gradient(180deg,#fff,#fff7fb);
padding:12px;display:flex;align-items:center;justify-content:center;position:relative;
box-shadow:inset 0 8px 30px rgba(250,240,250,0.4);overflow:hidden}
.grid{display:grid;gap:var(--gap);grid-template-columns:repeat(var(--cols),var(--tile));
grid-auto-rows:var(--tile);justify-content:center;align-content:center;touch-action:none;user-select:none}
.cell{width:var(--tile);height:var(--tile);border-radius:12px;display:flex;align-items:center;justify-content:center;
background:linear-gradient(180deg,#fff,#fffefc);box-shadow:0 4px 10px rgba(10,10,30,.04);
cursor:grab;transition:transform .12s,opacity .12s;position:relative;border:1px solid rgba(0,0,0,.04);
overflow:visible;will-change:transform,opacity;padding:0}
.cell img{width:78%;height:78%;object-fit:contain;pointer-events:none;display:block}
.cell.pop{animation:pop var(--pop-dur) cubic-bezier(.2,.9,.2,1) forwards}
@keyframes pop{0%{transform:scale(1);opacity:1}40%{transform:scale(1.45)}100%{transform:scale(0);opacity:0}}
.controls{display:flex;gap:10px;justify-content:center;padding:8px 6px;flex-wrap:wrap}
.btn{padding:10px 14px;border-radius:14px;border:0;font-weight:800;background:#fff;cursor:pointer;
box-shadow:0 8px 22px rgba(20,20,60,.06);min-width:90px}
.btn.primary{background:linear-gradient(90deg,var(--accent),#ff9ac8);color:#fff}
.footer{display:flex;align-items:center;justify-content:space-between;padding:8px 6px}
.progress{height:12px;width:200px;background:#eee;border-radius:999px;overflow:hidden}
.progress i{display:block;height:100%;width:0;background:linear-gradient(90deg,#ff9ac8,#ff6aa8);transition:width 320ms ease}
@media(max-width:720px){:root{--tile:54px;--gap:3px}.card{padding:10px}}
</style>
</head>
<body>
<div class="stage">
  <div class="card" id="card">
    <header>
      <div class="brand">
        <div class="logo">üç¨</div>
        <div>
          <div style="font-weight:900;font-size:18px">Candy Match</div>
          <div class="meta" style="font-size:13px;color:#666">Images from GitHub</div>
        </div>
      </div>
      <div class="hud">
        <div class="pill"><small>Level</small><div id="level">1</div></div>
        <div class="pill"><small>Score</small><div id="score">0</div></div>
        <div class="pill"><small>Moves</small><div id="moves">40</div></div>
      </div>
    </header>

    <div class="content">
      <div class="grid-area">
        <div id="gridWrap" class="grid-wrap">
          <div id="grid" class="grid" role="grid" aria-label="Candy grid"></div>
        </div>
      </div>

      <div class="controls">
        <button id="restart" class="btn primary">Restart</button>
        <button id="shuffle" class="btn">Shuffle</button>
        <button id="useBombBtn" class="btn">Use Bomb</button>
      </div>
    </div>

    <div class="footer">
      <div id="comboText" style="font-weight:900;color:var(--accent)">Combo √ó1</div>
      <div class="progress" aria-hidden><i id="progressBar"></i></div>
    </div>
  </div>
</div>

<script>
// ‚úÖ ‡§Ø‡§π‡§æ‡§Å ‡§Ö‡§™‡§®‡§æ GitHub RAW BASE URL ‡§°‡§æ‡§≤‡•ã (folder ‡§§‡§ï):
// ‡§â‡§¶‡§æ‡§π‡§∞‡§£: const GITHUB_BASE = "https://raw.githubusercontent.com/askirar275-wq/Candy/main/";
const GITHUB_BASE = "";

// ‡§Ö‡§¨ paths dynamic ‡§¨‡§®‡•á‡§Ç‡§ó‡•á
const IMAGE_FILES = [
  "images/candy1.png","images/candy2.png","images/candy3.png","images/candy4.png","images/candy5.png",
  "images/candy6.png","images/candy7.png","images/candy8.png","images/candy9.png","images/candy10.png"
].map(f => (GITHUB_BASE ? GITHUB_BASE + f : f));

const BOMB_FILE = GITHUB_BASE ? GITHUB_BASE + "images/bomb.jpg" : "images/bomb.jpg";

const WIDTH=8,HEIGHT=8,SIZE=WIDTH*HEIGHT;
const grid=document.getElementById('grid'); let CELL_ELEMENTS=[];
let state={board:[],score:0,moves:40,combo:1,nextId:1},locked=false;

function makeTile(src){return{id:state.nextId++,src:src||IMAGE_FILES[Math.floor(Math.random()*IMAGE_FILES.length)]};}
function randTile(){return makeTile();}

function createCellsOnce(){
  grid.innerHTML=''; CELL_ELEMENTS=[];
  for(let i=0;i<SIZE;i++){
    const el=document.createElement('button'); el.className='cell'; el.dataset.index=i;
    const img=document.createElement('img'); el.appendChild(img);
    el.addEventListener('pointerdown',onDown); grid.appendChild(el);
    CELL_ELEMENTS.push({button:el,img});
  }
}

function renderFast(){
  for(let i=0;i<SIZE;i++){
    if(!state.board[i]) state.board[i]=randTile();
    const t=state.board[i], e=CELL_ELEMENTS[i]; if(!e) continue;
    if(e.img.src!==t.src) e.img.src=t.src;
  }
  updateHUD();
}

function findMatches(bd){
  const m=[];
  for(let r=0;r<HEIGHT;r++){let run=[r*WIDTH];
    for(let c=1;c<WIDTH;c++){const p=r*WIDTH+c-1,i=r*WIDTH+c;
      if(bd[i]&&bd[p]&&bd[i].src===bd[p].src) run.push(i);
      else{if(run.length>=3)m.push([...run]); run=[i];}
    } if(run.length>=3)m.push([...run]);
  }
  for(let c=0;c<WIDTH;c++){let run=[c];
    for(let r=1;r<HEIGHT;r++){const p=(r-1)*WIDTH+c,i=r*WIDTH+c;
      if(bd[i]&&bd[p]&&bd[i].src===bd[p].src) run.push(i);
      else{if(run.length>=3)m.push([...run]); run=[i];}
    } if(run.length>=3)m.push([...run]);
  }
  return m;
}

function resolveChain(){
  if(locked) return; locked=true;
  const matches=findMatches(state.board);
  if(!matches.length){locked=false;return;}
  const remove=new Set(); matches.forEach(r=>r.forEach(i=>remove.add(i)));
  remove.forEach(i=>{const el=CELL_ELEMENTS[i].button; el.classList.add('pop'); state.board[i]=null;});
  state.score+=remove.size*10; updateHUD();
  setTimeout(()=>{
    for(let c=0;c<WIDTH;c++){
      const col=[]; for(let r=HEIGHT-1;r>=0;r--){const idx=r*WIDTH+c; if(state.board[idx]) col.push(state.board[idx]);}
      while(col.length<HEIGHT) col.push(randTile());
      for(let r=HEIGHT-1,i=0;r>=0;r--,i++) state.board[r*WIDTH+c]=col[i];
    }
    renderFast(); locked=false; resolveChain();
  },350);
}

let dragFrom=null;
function onDown(e){
  if(locked)return; const idx=Number(e.currentTarget.dataset.index);
  dragFrom=idx; document.addEventListener('pointerup',onUp,{once:true});
}
function onUp(e){
  if(dragFrom==null)return;
  const t=document.elementFromPoint(e.clientX,e.clientY);
  const cell=t.closest('.cell'); if(!cell)return;
  const idx=Number(cell.dataset.index);
  if(isAdjacent(dragFrom,idx)){
    [state.board[dragFrom],state.board[idx]]=[state.board[idx],state.board[dragFrom]];
    renderFast(); state.moves--; updateHUD(); resolveChain();
  }
  dragFrom=null;
}
function isAdjacent(a,b){const r1=Math.floor(a/WIDTH),c1=a%WIDTH,r2=Math.floor(b/WIDTH),c2=b%WIDTH;
  return Math.abs(r1-r2)+Math.abs(c1-c2)===1;}

document.getElementById('restart').onclick=()=>initBoard();
document.getElementById('shuffle').onclick=()=>{state.board.sort(()=>Math.random()-0.5);renderFast();}
document.getElementById('useBombBtn').onclick=()=>{
  const idx=Math.floor(Math.random()*SIZE);
  state.board[idx]=makeTile(BOMB_FILE); renderFast();
  setTimeout(()=>{
    const r=Math.floor(idx/WIDTH),c=idx%WIDTH;
    for(let dr=-1;dr<=1;dr++)for(let dc=-1;dc<=1;dc++){
      const rr=r+dr,cc=c+dc; if(rr>=0&&rr<HEIGHT&&cc>=0&&cc<WIDTH) state.board[rr*WIDTH+cc]=null;
    }
    renderFast(); resolveChain();
  },250);
};

function updateHUD(){
  document.getElementById('score').textContent=state.score;
  document.getElementById('moves').textContent=state.moves;
  document.getElementById('comboText').textContent="Combo √ó"+state.combo;
  document.getElementById('progressBar').style.width=Math.min(100,state.score/10)+'%';
}

function initBoard(){
  state.board=new Array(SIZE).fill(null).map(()=>randTile());
  while(findMatches(state.board).length) state.board=new Array(SIZE).fill(null).map(()=>randTile());
  state.score=0; state.moves=40; state.combo=1; renderFast();
}

createCellsOnce();
initBoard();
</script>
</body>
</html>
