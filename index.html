<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<title>ChatApp Login</title>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
:root{
 --bg:#0b0f1a;--card:#12182b;--text:#fff;--muted:#9aa4bf;
 --accent:#4f8cff;--border:rgba(255,255,255,.15)
}
.light{--bg:#f4f6fb;--card:#fff;--text:#111;--muted:#666;--border:rgba(0,0,0,.1)}
*{box-sizing:border-box}
body{margin:0;font-family:system-ui;background:var(--bg);color:var(--text)}
.app{max-width:420px;margin:auto;height:100vh;display:flex;flex-direction:column}
.header{padding:12px;background:var(--card);display:flex;justify-content:space-between}
.page{flex:1;display:none;padding:16px}
.page.active{display:block}
.card{background:var(--card);border:1px solid var(--border);border-radius:16px;padding:16px;margin-top:40px}
input{width:100%;padding:12px;border-radius:14px;border:1px solid var(--border);background:none;color:var(--text);margin:8px 0}
button{width:100%;padding:12px;border-radius:14px;border:1px solid var(--border);background:none;color:var(--text);margin-top:10px}
button:active{transform:scale(.95)}
.chat{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:10px;margin:10px 0}
.chatScreen{position:fixed;inset:0;background:var(--bg);display:none;flex-direction:column}
.messages{flex:1;padding:10px;overflow:auto}
.msg{max-width:75%;padding:8px 12px;border-radius:14px;margin:6px 0}
.me{margin-left:auto;background:var(--accent);color:#fff}
.other{background:var(--card);border:1px solid var(--border)}
.inputBar{display:flex;gap:8px;padding:10px;border-top:1px solid var(--border)}
</style>
</head>

<body>
<div class="app">

<div class="header">
  <b>ChatApp</b>
  <button onclick="toggleMode()">üåó</button>
</div>

<!-- LOGIN -->
<div class="page active" id="login">
  <div class="card">
    <h3>Login</h3>
    <input id="loginEmail" placeholder="Email">
    <input id="loginPass" type="password" placeholder="Password">
    <button onclick="login()">Login</button>
    <p style="text-align:center">No account? <span onclick="show('signup')" style="color:var(--accent)">Sign up</span></p>
  </div>
</div>

<!-- SIGNUP -->
<div class="page" id="signup">
  <div class="card">
    <h3>Sign Up</h3>
    <input id="signEmail" placeholder="Email">
    <input id="signPass" type="password" placeholder="Password">
    <button onclick="signup()">Create Account</button>
    <p style="text-align:center">Already have account? <span onclick="show('login')" style="color:var(--accent)">Login</span></p>
  </div>
</div>

<!-- HOME -->
<div class="page" id="home">
  <h3>Chats</h3>
  <div class="chat" onclick="openChat()">Global Chat</div>
  <button onclick="logout()">Logout</button>
</div>

</div>

<!-- CHAT -->
<div class="chatScreen" id="chatScreen">
  <div class="header">
    <button onclick="closeChat()">‚Üê</button>
    <b>Global Chat</b>
  </div>
  <div class="messages" id="messages"></div>
  <div class="inputBar">
    <input id="msgInput" placeholder="Type message">
    <button onclick="sendMsg()">Send</button>
  </div>
</div>

<script>
/* üî• FIREBASE CONFIG (PASTE YOUR DETAILS) */
firebase.initializeApp({
 apiKey:"YOUR_API_KEY",
 authDomain:"YOUR_PROJECT.firebaseapp.com",
 projectId:"YOUR_PROJECT_ID"
});
const auth=firebase.auth();
const db=firebase.firestore();

/* THEME */
function toggleMode(){document.body.classList.toggle('light')}
function show(id){
 document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
 document.getElementById(id).classList.add('active');
}

/* AUTH */
function signup(){
 auth.createUserWithEmailAndPassword(
  signEmail.value,signPass.value
 ).then(()=>show('home')).catch(e=>alert(e.message));
}
function login(){
 auth.signInWithEmailAndPassword(
  loginEmail.value,loginPass.value
 ).then(()=>show('home')).catch(e=>alert(e.message));
}
function logout(){
 auth.signOut(); show('login');
}
auth.onAuthStateChanged(u=>{if(u)show('home')});

/* CHAT */
function openChat(){
 document.getElementById("chatScreen").style.display="flex";
 load();
}
function closeChat(){
 document.getElementById("chatScreen").style.display="none";
}
function sendMsg(){
 if(!msgInput.value) return;
 db.collection("messages").add({
  text:msgInput.value,
  uid:auth.currentUser.uid,
  time:firebase.firestore.FieldValue.serverTimestamp()
 });
 msgInput.value="";
}
function load(){
 db.collection("messages").orderBy("time").onSnapshot(s=>{
  messages.innerHTML="";
  s.forEach(d=>{
   let m=d.data();
   let div=document.createElement("div");
   div.className="msg "+(m.uid===auth.currentUser.uid?"me":"other");
   div.innerText=m.text;
   messages.appendChild(div);
  });
  messages.scrollTop=9999;
 });
}
</script>
</body>
</html>
