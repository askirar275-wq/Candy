<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ChatApp</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  margin:0;
  font-family:system-ui, Arial;
  background:#0b0f1a;
  color:#fff;
}
.container{
  max-width:420px;
  margin:auto;
  padding:20px;
}
.card{
  background:#12182b;
  padding:16px;
  border-radius:14px;
  margin-top:20px;
  border:1px solid rgba(255,255,255,.15);
}
input,button{
  width:100%;
  padding:12px;
  margin:6px 0;
  border-radius:12px;
  border:1px solid rgba(255,255,255,.2);
  background:none;
  color:#fff;
}
button{
  cursor:pointer;
}
button:active{transform:scale(.95)}
.msg{
  padding:10px 14px;
  border-radius:14px;
  margin:6px 0;
  max-width:75%;
}
.me{background:#4f8cff;margin-left:auto}
.other{background:#1b2238}
#chat{display:none}
</style>
</head>

<body>

<div class="container">

  <!-- LOGIN -->
  <div class="card" id="loginBox">
    <h3>ChatApp Login</h3>
    <input id="email" type="email" placeholder="Email">
    <input id="password" type="password" placeholder="Password">
    <button onclick="signup()">Sign Up</button>
    <button onclick="login()">Login</button>
  </div>

  <!-- CHAT -->
  <div class="card" id="chat">
    <h3>Global Chat</h3>
    <div id="messages"></div>
    <input id="msgInput" placeholder="Type message">
    <button onclick="sendMsg()">Send</button>
    <button onclick="logout()">Logout</button>
  </div>

</div>

<!-- ðŸ”¥ FIREBASE COMPAT SDKs -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
/* âœ… YOUR FIREBASE CONFIG (CORRECTLY PLACED) */
const firebaseConfig = {
  apiKey: "AIzaSyA7U96MP2BheQ1ilIUqd2UgycPs8KVC-Gc",
  authDomain: "chatapp-d38d3.firebaseapp.com",
  projectId: "chatapp-d38d3",
  storageBucket: "chatapp-d38d3.appspot.com",
  messagingSenderId: "321814992234",
  appId: "1:321814992234:web:d1d8eb9d63fcafc53ec113"
};

/* Initialize Firebase */
firebase.initializeApp(firebaseConfig);

const auth = firebase.auth();
const db   = firebase.firestore();

/* AUTH */
function signup(){
  auth.createUserWithEmailAndPassword(email.value, password.value)
    .then(()=>alert("Signup successful"))
    .catch(e=>alert(e.message));
}

function login(){
  auth.signInWithEmailAndPassword(email.value, password.value)
    .catch(e=>alert(e.message));
}

function logout(){
  auth.signOut();
}

/* AUTH STATE */
auth.onAuthStateChanged(user=>{
  if(user){
    loginBox.style.display="none";
    chat.style.display="block";
    loadMessages();
  }else{
    loginBox.style.display="block";
    chat.style.display="none";
  }
});

/* CHAT */
function sendMsg(){
  if(!msgInput.value) return;
  db.collection("messages").add({
    text: msgInput.value,
    uid: auth.currentUser.uid,
    time: firebase.firestore.FieldValue.serverTimestamp()
  });
  msgInput.value="";
}

function loadMessages(){
  db.collection("messages").orderBy("time")
    .onSnapshot(snap=>{
      messages.innerHTML="";
      snap.forEach(d=>{
        const m=d.data();
        const div=document.createElement("div");
        div.className="msg "+(m.uid===auth.currentUser.uid?"me":"other");
        div.innerText=m.text;
        messages.appendChild(div);
      });
      messages.scrollTop=9999;
    });
}
</script>

</body>
</html>
