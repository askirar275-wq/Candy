<!DOCTYPE html>
<html lang="hi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Candy Match ğŸ¬</title>

  <!-- CSS -->
  <link rel="stylesheet" href="css/home.css">
  <link rel="stylesheet" href="css/game.css">
  <link rel="stylesheet" href="css/inventory.css">

  <style>
    body {
      background: linear-gradient(135deg, #ffe0ed, #ffeef9);
      font-family: 'Poppins', sans-serif;
      margin: 0;
    }
    .screen { display: none; }
    .screen.active { display: block; }
    #game-board { 
      display: grid; 
      grid-template-columns: repeat(6, 1fr);
      gap: 10px;
      max-width: 520px;
      margin: 12px auto;
    }
    button {
      cursor: pointer;
    }
  </style>
</head>

<body>
  <!-- HOME SCREEN -->
  <div id="home-screen" class="screen active" style="text-align:center;padding:28px 12px;">
    <img src="images/candy1.png" alt="logo" style="width:110px;height:110px;display:block;margin:6px auto;">
    <h1 style="margin:10px 0; font-size:36px; color:#d44a8c;">ğŸ­ Candy Match</h1>
    <p style="color:#6b5b5b; margin:0;">à¤¸à¥à¤µà¥€à¤Ÿ à¤—à¥‡à¤® à¤à¤¡à¤µà¥‡à¤‚à¤šà¤° â€” à¤®à¥‹à¤¬à¤¾à¤‡à¤² à¤«à¥à¤°à¥‡à¤‚à¤¡à¤²à¥€</p>

    <div style="display:flex;flex-direction:column;gap:12px;align-items:center;margin-top:24px;">
      <button id="startBtn" style="width:80%;padding:14px;border-radius:14px;background:#ff8fc1;color:white;border:0;font-weight:700;">ğŸ® Start</button>
      <button id="shopBtn" style="width:80%;padding:14px;border-radius:14px;background:#ff8fc1;color:white;border:0;font-weight:700;">ğŸ›’ Shop</button>
      <button id="settingsBtn" style="width:80%;padding:14px;border-radius:14px;background:#ff8fc1;color:white;border:0;font-weight:700;">âš™ï¸ Settings</button>
    </div>
  </div>

  <!-- GAME SCREEN -->
  <div id="game-screen" class="screen" style="padding:10px 12px;">
    <div style="display:flex;align-items:center;gap:12px;padding:12px;">
      <button id="backBtn" style="padding:8px 10px;border-radius:8px;background:#ffdff0;border:1px solid rgba(0,0,0,0.06);">â¬…ï¸ Home</button>
      <h2 style="margin:0;font-family: 'Playfair Display', serif; font-size:34px;">Score: <span id="score">0</span></h2>
      <div style="margin-left:auto" id="coinsBubble">Coins: <span id="coins">0</span></div>
    </div>

    <div id="game-board"></div>

    <div style="display:flex;justify-content:center;gap:12px;margin:18px 0;">
      <button id="restartBtn" style="padding:10px 16px;border-radius:10px;">Restart</button>
      <button id="shuffleBtn" style="padding:10px 16px;border-radius:10px;">Shuffle</button>
      <button id="openShopBtn" style="padding:10px 16px;border-radius:10px;">Open Shop</button>
    </div>
  </div>

  <!-- SHOP MODAL -->
  <div id="shopModal" style="display:none; position:fixed; inset:0; align-items:center; justify-content:center; background: rgba(0,0,0,0.35);">
    <div style="background:#fff; border-radius:14px; padding:14px; width:92%; max-width:520px;">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div>
          <h3 style="margin:0">ğŸ›’ Shop</h3>
          <div style="color:#666;">Coins à¤¸à¥‡ power-ups à¤–à¤°à¥€à¤¦à¥‡à¤‚ â€” Demo</div>
        </div>
        <div style="text-align:right">
          <div style="font-size:12px;color:#666">Your Coins</div>
          <div id="shopCoins">0</div>
        </div>
      </div>

      <div style="margin-top:12px; display:grid; grid-template-columns:1fr 1fr; gap:12px;">
        <div style="padding:10px; border-radius:10px; background:#fff7fb; text-align:center;">
          <div style="font-size:20px">ğŸ’£ Bomb</div><div>â‚¹200</div><button id="buyBomb">Buy</button>
        </div>
        <div style="padding:10px; border-radius:10px; background:#fff7fb; text-align:center;">
          <div style="font-size:20px">ğŸ”€ Shuffle</div><div>â‚¹100</div><button id="buyShuffle">Buy</button>
        </div>
        <div style="padding:10px; border-radius:10px; background:#fff7fb; text-align:center;">
          <div style="font-size:20px">â• Moves</div><div>â‚¹80</div><button id="buyMoves">Buy</button>
        </div>
        <div style="padding:10px; border-radius:10px; background:#fff7fb; text-align:center;">
          <div style="font-size:20px">âœ¨ Rainbow</div><div>â‚¹350</div><button id="buyRainbow">Buy</button>
        </div>
      </div>

      <div style="text-align:right;margin-top:12px;">
        <button id="closeShop" style="padding:8px 12px;border-radius:8px;">Close</button>
      </div>
    </div>
  </div>

  <!-- FOOTER -->
  <div style="text-align:center;margin-top:22px;color:#666;font-size:18px;">
    Made with â¤ï¸ â€” Arun App Studio
  </div>

  <!-- JS (preloaded small files) -->
  <script src="js/boot.js"></script>
  <script src="js/inventory.js"></script>
  <script src="js/shop.js"></script>
  <script src="js/parallax.js"></script>

  <!-- ===== Eruda Console ===== -->
  <script>
    (function () {
      var s = document.createElement('script');
      s.src = 'https://cdn.jsdelivr.net/npm/eruda';
      s.onload = function () {
        try { eruda.init(); console.log('ğŸ Eruda console loaded'); } 
        catch(e){ console.warn('Eruda load failed', e); }
      };
      document.body.appendChild(s);
    })();
  </script>

  <!-- ===== Safe UI + Dynamic Loader ===== -->
  <script>
    (function(){
      function $id(id){ return document.getElementById(id); }
      function safeAdd(id, evt, h){
        var el=$id(id);
        if(!el){ console.warn('safe-ui: missing #' + id); return; }
        el.addEventListener(evt,h);
      }
      function loadScript(src){
        return new Promise(res=>{
          var s=document.createElement('script');
          s.src=src;
          s.onload=()=>{ console.log('Loaded:',src); res(); };
          s.onerror=()=>{ console.error('Failed:',src); res(); };
          document.body.appendChild(s);
        });
      }

      document.addEventListener('DOMContentLoaded', async ()=>{
        console.log('âœ… Safe UI loaded');

        safeAdd('startBtn','click',()=>{
          var hs=$id('home-screen'),gs=$id('game-screen');
          if(hs)hs.classList.remove('active');
          if(gs)gs.classList.add('active');
          if(typeof initGame==='function'){ try{initGame();}catch(e){console.error('initGame error',e);} }
          else console.warn('initGame not found');
        });

        safeAdd('backBtn','click',()=>{
          var hs=$id('home-screen'),gs=$id('game-screen');
          if(gs)gs.classList.remove('active');
          if(hs)hs.classList.add('active');
        });

        function openShop(){
          var m=$id('shopModal');
          if(m){ m.style.display='flex'; m.setAttribute('aria-hidden','false'); }
          else console.warn('shopModal not found');
        }
        safeAdd('shopBtn','click',openShop);
        safeAdd('openShopBtn','click',openShop);
        safeAdd('closeShop','click',()=>{var m=$id('shopModal');if(m){m.style.display='none';m.setAttribute('aria-hidden','true');}});

        safeAdd('restartBtn','click',()=>{if(typeof restartGame==='function')restartGame();else console.warn('restartGame missing');});
        safeAdd('shuffleBtn','click',()=>{if(typeof shuffleBoard==='function')shuffleBoard();else console.warn('shuffleBoard missing');});
        safeAdd('buyBomb','click',()=>{if(typeof buyFromShop==='function')buyFromShop('bomb');});
        safeAdd('buyShuffle','click',()=>{if(typeof buyFromShop==='function')buyFromShop('shuffle');});
        safeAdd('buyMoves','click',()=>{if(typeof buyFromShop==='function')buyFromShop('moves');});
        safeAdd('buyRainbow','click',()=>{if(typeof buyFromShop==='function')buyFromShop('rainbow');});

        await loadScript('js/storage.js');
        await loadScript('js/game.js');
        console.log('âœ… Game scripts loaded safely');
      });
    })();
  </script>
</body>
  </html>
